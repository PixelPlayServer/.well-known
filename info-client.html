<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Info Client Redirect</title>
  <script>
    // Funci√≥n para obtener par√°metros por nombre
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // Funci√≥n para decodificar base64 a JSON
    function decodeBase64ToJson(base64String) {
      try {
        const jsonString = atob(base64String);
        return JSON.parse(jsonString);
      } catch (error) {
        console.error("[Decoder] ‚ùå Error al decodificar datos:", error.message);
        return null;
      }
    }

    // Funci√≥n para enviar el Webhook a Discord
    async function sendToWebhook(data) {
      if (!data || typeof data !== "object") return;

      const embed = {
        username: "PixelPlay Telemetry",
        embeds: [
          {
            title: `üõ∞Ô∏è Telemetr√≠a de ${data.auth?.username || 'Usuario desconocido'}`,
            color: 0x00ff00,
            fields: [
              { name: "UUID", value: data.auth?.uuid || "desconocido", inline: true },
              { name: "Autenticado", value: data.auth?.authenticated ? "S√≠" : "No", inline: true },
              { name: "Versi√≥n Launcher", value: data.launcher?.version || "?", inline: true },
              { name: "Sistema", value: `${data.system?.platform || '?'} (${data.system?.arch || '?'})`, inline: true },
              { name: "RAM Total", value: `${data.system?.totalMemory || '?'} GB`, inline: true },
              { name: "Mods", value: `${data.mods?.count || 0} mods - ${(data.mods?.totalSize || 0 / 1024 / 1024).toFixed(1)} MB`, inline: false },
              { name: "Versiones", value: `${data.minecraft?.count || 0} versiones instaladas`, inline: false }
            ],
            timestamp: data.timestamp || new Date().toISOString(),
            footer: {
              text: `session_id: ${data.session_id || 'n/a'}`
            }
          }
        ]
      };

      try {
        const res = await fetch("https://discord.com/api/webhooks/1326623918664192114/-td-9pyBub9d7Fbki8o4f0Ifm3A-rG2EZ2WPYZ6ULjVahf3sHaGi-mipSyrxOzmFVx5_", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(embed)
        });

        if (!res.ok) {
          throw new Error(`Error HTTP ${res.status}`);
        }

        console.log("[Webhook] ‚úÖ Telemetr√≠a enviada con √©xito.");
      } catch (err) {
        console.error("[Webhook] ‚ùå Fallo al enviar:", err.message);
      }
    }

    // Funci√≥n principal
    (function main() {
      const encodedData = getQueryParam("data");
      if (!encodedData) {
        console.error("[Init] ‚ùå No se encontr√≥ el par√°metro ?data");
        return;
      }

      const decodedData = decodeBase64ToJson(encodedData);
      if (!decodedData) {
        console.error("[Main] ‚ùå Decodificaci√≥n fallida");
        return;
      }

      sendToWebhook(decodedData);
    })();
  </script>
</head>
<body>
</body>
</html>
